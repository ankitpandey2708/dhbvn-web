name: Keep Alive

on:
  schedule:
    - cron: '*/5 * * * *' # Run every 5 minutes
  workflow_dispatch: # Allow manual trigger

jobs:
  ping:
    runs-on: ubuntu-latest
    steps:
      - name: Ping Webhook Health Check
        run: |
          # Use secrets.APP_URL if defined, otherwise try to guess or fail gracefully
          TARGET_URL="${{ secrets.APP_URL }}"
          if [ -z "$TARGET_URL" ]; then
            echo "Secrets APP_URL not found, using default URL structure (might need update)"
             # We can't easily guess the full Vercel URL without user input, but we can try the one they might have set or warn them.
             # Better approach: Just print a warning and exit success so we don't spam them with errors if not set.
             echo "Please set APP_URL secret in GitHub Settings"
             exit 0
          fi
          
          echo "Pinging $TARGET_URL/api/telegram/webhook"
          curl -s -o /dev/null -w "%{http_code}" "$TARGET_URL/api/telegram/webhook"
